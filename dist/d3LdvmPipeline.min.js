!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?exports.d3LdvmPipeline=e(require("d3")):t.d3LdvmPipeline=e(t.d3)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(){var t=1800,e=700,n=70,r=["suit","licensing","resolved"],o=function(t){return t},i=function(i){return i.each(function(i){function u(){return w.append("svg").attr("class","ldvmÄ›").attr("width",t).attr("height",e)}function s(){var r=a["default"].layout.force().nodes(k).links(P).size([t,e]).linkDistance(3*n).charge(-600).gravity(.1).on("tick",x);return r=o(r)}function f(){k.forEach(function(t){return t.size(n)}),E.append("defs").selectAll("marker").data(O).enter().append(function(t){return t.render()}),E.append("g").selectAll("path").data(C.links()).enter().append(function(t){return t.render()}),E.append("g").selectAll(".ldvm-component").data(C.nodes()).enter().append(function(t){return t.render()}).call(C.drag)}function d(){E.append(function(){return M.render()}).attr("transform","translate("+t/2+", "+e/2+")")}function h(){M.remove()}function m(){k.forEach(function(t){return t.update()}),P.forEach(function(t){return t.update()}),M.update()}function x(t){M.alpha=t.alpha,c["default"](t.alpha,k,P),m()}var b=l["default"](i),k=b.components,P=b.bindings,w=a["default"].select(this),E=u(),C=s(),M=new p["default"](_,g),O=r.map(function(t){return new v["default"](n/10,t)}),z=!1;w.append(function(){return y["default"].render()}),d(),C.on("end",function(){z||(h(),f(),m(),z=!0)}),C.start()})},u=function(){return i};return i.width=function(e){return void 0===e?t:u(t=e)},i.height=function(t){return void 0===t?e:u(e=t)},i.componentSize=function(t){return void 0===t?n:u(n=t)},i.componentTypes=function(t){return void 0===t?r:u(r=t)},i.configureForce=function(t){return void 0===t?o:u(o=t)},i}var o=function(t){return t&&t.__esModule?t:{"default":t}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var i=n(1),a=o(i),u=n(7),s=(o(u),n(2)),l=o(s),f=n(3),c=o(f),d=n(4),p=o(d),h=n(5),v=o(h),m=n(6),y=o(m),g=.005,_=.1;t.exports=e["default"]},function(e,n,r){e.exports=t},function(t,e,n){"use strict";function r(t){var e={},n=t.components.map(function(t){var n=new a["default"](t,t.inputs,t.outputs);return t.inputs.forEach(function(t,r){t.rank=r,t.component=n,e[t.uri]=t}),t.outputs.forEach(function(t,r){t.rank=r,t.component=n,e[t.uri]=t}),n}),r=t.bindings.map(function(t){return new s["default"](t,e[t.sourceUri],e[t.targetUri])});return{components:n,bindings:r}}var o=function(t){return t&&t.__esModule?t:{"default":t}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var i=n(9),a=o(i),u=n(10),s=o(u);t.exports=e["default"]},function(t,e,n){"use strict";function r(t,e,n){var r=50*t;n.forEach(function(t){t.source.x-=r,t.target.x+=r,t.source.y+=t.rank*(r/2)}),e.filter(function(t){return t.type==o.DATASOURCE}).forEach(function(t){return t.x-=r}),e.filter(function(t){return t.type==o.VISUALIZER}).forEach(function(t){return t.x+=r}),e.forEach(function(t){t.x-=r/4,t.y-=r/4})}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var o=n(11);t.exports=e["default"]},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),u=(r(a),n(12)),s=200,l=30,f=4,c=function(){function t(e,n){o(this,t),this.start=e,this.threshold=n,this.alpha=e,this._element=null}return i(t,[{key:"render",value:function(){var t=this;if(!this._element){var e=u.createElement("g").attr("class","ldvm-loading-bar");e.append(function(){return t._renderBar()}),e.append(function(){return t._renderLabel()}),this._element=e}return this._element.node()}},{key:"update",value:function(){this._element&&(this._element.select("text").text("Loading visualization..."+this._getProgressPercentage()+"%"),this._element.select(".ldvm-inner").attr("width",this._getBarWidth()))}},{key:"remove",value:function(){var t=this;this._element&&this._element.transition().style("opacity",0).each("end",function(){t._element.remove(),t._element=null})}},{key:"_renderLabel",value:function(){return u.createElement("text").text("Loading visualization..."+this._getProgressPercentage()+"%").attr("x",0).attr("y",0).attr("text-anchor","middle").attr("dominant-baseline","middle").node()}},{key:"_renderBar",value:function(){var t=u.createElement("g");return t.append("rect").attr("class","ldvm-outer").attr("width",s).attr("height",l).attr("x",-s/2).attr("y",-l/2).attr("rx",f).attr("ry",f),t.append("rect").attr("class","ldvm-inner").attr("width",this._getBarWidth()).attr("height",l).attr("x",-s/2).attr("y",-l/2).attr("rx",f).attr("ry",f),t.node()}},{key:"_getProgressPercentage",value:function(){return Math.round(100*(this.start-this.alpha)/(this.start-this.threshold))}},{key:"_getBarWidth",value:function(){return this._getProgressPercentage()/100*s}}]),t}();e["default"]=c,t.exports=e["default"]},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),u=(r(a),n(12)),s=function(){function t(e,n){o(this,t),this.size=e,this.type=n}return i(t,[{key:"render",value:function(){var t=u.createElement("marker").attr("id",this.type).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",-1.5).attr("markerWidth",this.size).attr("markerHeight",this.size).attr("orient","auto");return t.append("path").attr("d","M0,-5L10,0L0,5"),t.node()}}]),t}();e["default"]=s,t.exports=e["default"]},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=r(o),a="Default label",u="",s="Default content",l=0,f=0,c=null,d=function(){};d.render=function(){return c=i["default"].select(document.createElement("div")).attr("class","ldvm-tooltip"),c.append("div").attr("class","ldvm-tooltip-label"),c.append("div").attr("class","ldvm-tooltip-uri"),c.append("div").attr("class","ldvm-tooltip-content"),c.node()},d.show=function(){c&&(c.select(".ldvm-tooltip-label").html(a),c.select(".ldvm-tooltip-uri").html(u),c.select(".ldvm-tooltip-content").html(s),c.transition().duration(200).style("top",f+"px").style("left",l+"px").style("opacity",1))},d.hide=function(){c&&c.transition().duration(200).style("opacity",0)};var p=function(){return d};d.label=function(t){return void 0===t?a:p(a=t)},d.uri=function(t){return void 0===t?u:p(u=t)},d.content=function(t){return void 0===t?s:p(s=t)},d.x=function(t){return void 0===t?l:p(l=t)},d.y=function(t){return void 0===t?f:p(f=t)},e["default"]=d,t.exports=e["default"]},function(t,e,n){var r=n(8);"string"==typeof r&&(r=[[t.id,r,""]]);n(13)(r,{})},function(t,e,n){e=t.exports=n(14)(),e.push([t.id,".ldvm-component-body{fill-opacity:1;stroke:#fff;stroke-width:1.5px}.ldvm-component-label{font:11px sans-serif;pointer-events:none;text-shadow:0 1px 0 #fff,1px 0 0 #fff,0 -1px 0 #fff,-1px 0 0 #fff}.ldvm-component-datasource{fill:#013C5A}.ldvm-component-analyzer,.ldvm-component-transformer{fill:#028E85}.ldvm-component-visualizer{fill:#02D6A1}.ldvm-component-port{fill:#4b676f;stroke:#fff;stroke-width:1.5px}.ldvm-link{fill:none;stroke:#666;stroke-width:1.5px}.ldvm-link.ldvm-licensing{stroke:green}.ldvm-link.ldvm-resolved{stroke-dasharray:0,2 1}.ldvm-loading-bar text{font:12px sans-serif;text-shadow:0 1px 1px #fff,1px 0 1px #fff,0 -1px 1px #fff,-1px 0 1px #fff}.ldvm-loading-bar .ldvm-outer{fill-opacity:0;stroke:#4b676f;stroke-width:1px}.ldvm-loading-bar .ldvm-inner{fill:#4b676f;fill-opacity:1}.ldvm-tooltip{max-width:300px;position:absolute;font:12px sans-serif;border:1px solid #6e97a3;border-radius:4px;pointer-events:none;background-color:rgba(255,255,255,.8);box-shadow:#fff 0 0 1px,#fff 0 0 1px;opacity:0}.ldvm-tooltip div{padding:5px}.ldvm-tooltip-label{font-weight:700;background-color:rgba(2,142,133,.8);color:#fff}.ldvm-tooltip-uri{color:#013C5A}",""])},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),u=r(a),s=n(6),l=r(s),f=n(12),c=8,d=function(){function t(e,n,r){o(this,t),this.data=e,this.inputs=n,this.outputs=r,this._size=70,this._element=null}return i(t,[{key:"render",value:function(){var t=this;return this._element||!function(){var e=f.createElement("g").attr("class","ldvm-component");e.style("opacity",0).transition().style("opacity",1),e.append(function(){return t._renderLabel()}),e.append(function(){return t._renderBody()}),t.inputs.forEach(function(n){return e.append(function(){return t._renderInput(n)})}),t.outputs.forEach(function(n){return e.append(function(){return t._renderOutput(n)})}),t._element=e}(),this._element.node()}},{key:"update",value:function(){this._element&&this._element.attr("transform","translate("+this.x+","+this.y+")")}},{key:"size",value:function(t){return void 0===t?this._size:(this._size=t,this)}},{key:"_renderLabel",value:function(){return f.createElement("text").text(this.data.label).attr("class","ldvm-component-label").attr("x",0).attr("y",this._size/2+10).attr("text-anchor","middle").node()}},{key:"_renderBody",value:function(){var t=this;return f.createElement("rect").attr("class","ldvm-component-body ldvm-component-"+this.data.type).attr("width",this._size).attr("height",this._size).attr("x",-this._size/2).attr("y",-this._size/2).attr("rx",c).attr("ry",c).on("mouseover",function(){return l["default"].label(t.data.label).uri(t.data.uri).content(t.data.htmlContent).x(f.realPosition(t._element).x).y(f.realPosition(t._element).y+t._size).show()}).on("mouseout",function(){return l["default"].hide()}).node()}},{key:"_renderInput",value:function(t){return this._renderPort(this._getInputCoords(t),t)}},{key:"_renderOutput",value:function(t){return this._renderPort(this._getOutputCoords(t),t)}},{key:"_renderPort",value:function(t,e){return f.createElement("circle").attr("class","ldvm-component-port").attr("cx",t.x).attr("cy",t.y).attr("r",this._getPortSize()/2).on("mouseover",function(){return l["default"].label(e.label).uri(e.uri).content("").x(u["default"].event.pageX).y(u["default"].event.pageY).show()}).on("mouseout",function(){return l["default"].hide()}).node()}},{key:"_getInputCoords",value:function(t){return{x:-this._size/2,y:this._getPortY(this.inputs.indexOf(t),this.inputs.length)}}},{key:"_getOutputCoords",value:function(t){return{x:this._size/2,y:this._getPortY(this.outputs.indexOf(t),this.outputs.length)}}},{key:"_getPortY",value:function(t,e){var n=this._size/e;return-this._size/2+t*n+n/2}},{key:"_getPortSize",value:function(){return this._size/6}},{key:"getPortCoords",value:function(t){var e=void 0;if(e=this._findPortByUri(this.inputs,t))return this._getInputCoords(e);if(e=this._findPortByUri(this.outputs,t))return this._getOutputCoords(e);throw new Error("Port does not exist: "+t)}},{key:"_findPortByUri",value:function(t,e){var n=t.filter(function(t){return t.uri==e});return n.length>0?n[0]:!1}}]),t}();e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),u=(r(a),n(12)),s=function(){function t(e,n,r){o(this,t),this.data=e,this.sourcePort=n,this.targetPort=r,this.source=n.component,this.target=r.component,this.rank=r.rank,this._element=null}return i(t,[{key:"render",value:function(){return this._element||(this._element=u.createElement("path").attr("class","ldvm-link ldvm-"+this.data.type).attr("marker-end","url(#"+this.data.type+")")),this._element.node()}},{key:"update",value:function(){if(this._element){var t=this.source.getPortCoords(this.sourcePort.uri),e=this.target.getPortCoords(this.targetPort.uri),n={x:this.source.x+t.x,y:this.source.y+t.y},r={x:this.target.x+e.x,y:this.target.y+e.y},o=r.x-n.x,i=r.y-n.y,a=Math.sqrt(o*o+i*i);this._element.attr("d","M"+n.x+","+n.y+"A"+a+","+a+" 0 0,1 "+r.x+","+r.y)}}}]),t}();e["default"]=s,t.exports=e["default"]},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="visualizer";e.VISUALIZER=r;var o="transformer";e.TRANSFORMER=o;var i="datasource";e.DATASOURCE=i;var a="analyzer";e.ANALYZER=a},function(t,e,n){"use strict";function r(t){return u["default"].select(document.createElementNS("http://www.w3.org/2000/svg",t))}function o(t){return t?{x:t.node().getBoundingClientRect().left+document.body.scrollLeft,y:t.node().getBoundingClientRect().top+document.body.scrollTop}:{x:0,y:0}}var i=function(t){return t&&t.__esModule?t:{"default":t}};Object.defineProperty(e,"__esModule",{value:!0}),e.createElement=r,e.realPosition=o;var a=n(1),u=i(a)},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=c[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(u(r.parts[i],e))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(u(r.parts[i],e));c[r.id]={id:r.id,refs:1,parts:a}}}}function o(t){for(var e=[],n={},r=0;r<t.length;r++){var o=t[r],i=o[0],a=o[1],u=o[2],s=o[3],l={css:a,media:u,sourceMap:s};n[i]?n[i].parts.push(l):e.push(n[i]={id:i,parts:[l]})}return e}function i(){var t=document.createElement("style"),e=h();return t.type="text/css",e.appendChild(t),t}function a(){var t=document.createElement("link"),e=h();return t.rel="stylesheet",e.appendChild(t),t}function u(t,e){var n,r,o;if(e.singleton){var u=m++;n=v||(v=i()),r=s.bind(null,n,u,!1),o=s.bind(null,n,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=a(),r=f.bind(null,n),o=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=i(),r=l.bind(null,n),o=function(){n.parentNode.removeChild(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}function s(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=y(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function l(t,e){{var n=e.css,r=e.media;e.sourceMap}if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function f(t,e){var n=e.css,r=(e.media,e.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(JSON.stringify(r))+" */");var o=new Blob([n],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var c={},d=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},p=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),h=d(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,m=0;t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=p());var n=o(t);return r(n,e),function(t){for(var i=[],a=0;a<n.length;a++){var u=n[a],s=c[u.id];s.refs--,i.push(s)}if(t){var l=o(t);r(l,e)}for(var a=0;a<i.length;a++){var s=i[a];if(0===s.refs){for(var f=0;f<s.parts.length;f++)s.parts[f]();delete c[s.id]}}}};var y=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];t.push(n[2]?"@media "+n[2]+"{"+n[1]+"}":n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(var o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}}])});